<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#020617">
  <title>Sport Center App</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

  <section id="login" class="screen active">
    <div class="login-wrapper">
      <div class="brand">
        <span class="material-icons-round" style="font-size: 48px; color: #10b981;">fitness_center</span>
        <h1>Sport Center</h1>
        <p>Performance & Sa√∫de</p>
      </div>
      <div class="login-box">
        <input type="tel" id="userEmail" placeholder="Seu Telefone ou 'admin'" autocomplete="off">
        <input type="password" id="userPass" placeholder="Sua Senha" value="123">
        <button onclick="autenticar()" class="btn-primary">ACESSAR CONTA</button>
      </div>
    </div>
  </section>

  <section id="dashProfessor" class="screen">
    <div class="header-top">
      <div>
        <h1 style="margin-bottom: 5px;">Painel do Coach</h1>
        <p>Gest√£o de Atletas (Online)</p>
      </div>
      <button onclick="logout()" class="btn-logout"><span class="material-icons-round">logout</span></button>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon green"><span class="material-icons-round">groups</span></div>
        <div><span class="stat-num" id="totalAlunos">0</span><span class="stat-desc">Alunos</span></div>
      </div>
      <div class="stat-card">
        <div class="stat-icon blue"><span class="material-icons-round">fitness_center</span></div>
        <div><span class="stat-num">--</span><span class="stat-desc">Ativos</span></div>
      </div>
    </div>

    <div class="admin-controls">
      <div class="search-box">
        <span class="material-icons-round">search</span>
        <input type="text" id="inputBusca" placeholder="Buscar aluno..." onkeyup="filtrarAlunos()">
      </div>
      <button onclick="toggleFormulario()" class="btn-add-mini"><span class="material-icons-round">person_add</span> Novo</button>
    </div>

    <div id="formCadastroAluno" class="form-panel hidden">
      <h4>Cadastrar Novo Atleta</h4>
      <div class="form-row">
        <input type="text" id="novoNome" placeholder="Nome Completo">
        <input type="tel" id="novoTel" placeholder="WhatsApp (Login)">
        <label style="font-size: 0.8rem; color: #aaa; margin-top: 5px;">Data de Vencimento</label>
        <input type="date" id="novoVencimento" style="color-scheme: dark;">
      </div>
      <button onclick="cadastrarAluno()" class="btn-primary" style="margin-top: 10px;">Confirmar Cadastro</button>
    </div>

    <h3 class="section-title" style="margin-top: 20px;">Meus Alunos</h3>
    <div id="listaAlunosCoach" class="student-grid"></div>
    <div style="height: 80px;"></div>
  </section>

  <section id="painelPersonal" class="screen">
    <button class="btn-back" onclick="mostrarTela('dashProfessor')"><span class="material-icons-round">arrow_back</span> Voltar</button>
    <div class="header-editor">
      <h2 id="alunoSendoEditado">Aluno: ...</h2>
      <p>Editando M√≥dulo: <span id="moduloAtualNome" class="highlight">A</span></p>
    </div>
    <div class="module-selector" id="botoesModulosAdmin"></div>
    <div id="listaSelecao" class="selection-list"></div>
    <div class="fixed-bottom-action">
      <button onclick="salvarTreinoPersonal()" class="btn-primary">Salvar na Nuvem <span class="material-icons-round">cloud_upload</span></button>
    </div>
  </section>

  <section id="estatisticas" class="screen">
    <div class="header-student">
      <h1>Minhas Metas</h1>
      <p>Sincronizado com a nuvem ‚òÅÔ∏è</p>
    </div>

    <div class="goal-card">
      <div class="goal-header"><span class="goal-title">‚öñÔ∏è Evolu√ß√£o Corporal</span></div>
      <div class="chart-container-line" style="position: relative; height: 220px; width:100%;">
        <canvas id="graficoPesoCanvas"></canvas>
      </div>
      <div class="weight-inputs-row">
        <div class="weight-box">
          <label>In√≠cio</label>
          <input type="number" id="pesoInicialInput" placeholder="00.0" readonly style="opacity: 0.7;">
        </div>
        <div class="arrow">‚ûî</div>
        <div class="weight-box active">
          <label>Atual (kg)</label>
          <input type="number" id="pesoAtualInput" placeholder="00.0" onblur="salvarPesoCorporal(this.value)">
        </div>
      </div>
      <p class="motivation-text" id="textoEvolucaoPeso">Mantenha o foco!</p>
    </div>

    <h3 class="section-title-small">Frequ√™ncia (Dias 100%)</h3>
    <div class="chart-card">
      <div class="bar-chart-container" id="graficoSemanal"></div>
      <p class="chart-legend">Treinos completos na semana</p>
    </div>

    <h3 class="section-title-small" style="margin-top: 30px;">An√°lise de For√ßa</h3>
    <div class="goal-card">
      <div class="goal-header" style="border:none; margin-bottom:5px; padding-bottom:0;">
        <span class="goal-title">üìä Evolu√ß√£o por Exerc√≠cio</span>
      </div>
      <p style="font-size:0.8rem; color:#94a3b8; margin-bottom:15px;">Selecione para ver o hist√≥rico:</p>
      <select id="selectExercicioGrafico" onchange="atualizarGraficoCarga()" class="input-dark-select">
        <option value="" disabled selected>Carregando dados...</option>
      </select>
      <div class="chart-container-line" style="position: relative; height: 220px; width:100%;">
        <canvas id="graficoCargaCanvas"></canvas>
      </div>
      <div class="stats-row-mini">
        <div class="stat-mini">
          <span class="stat-label">Carga Inicial</span>
          <span class="stat-value" id="cargaInicialDisplay">--</span>
        </div>
        <div class="stat-mini">
          <span class="stat-label">Recorde Atual</span>
          <span class="stat-value" id="recordeDisplay" style="color: #10b981;">--</span>
        </div>
      </div>
    </div>
    <div style="height: 100px;"></div>
  </section>

  <section id="treinos" class="screen">
    <div class="header-student">
      <div>
        <h1>Ol√°, <span id="nomeAlunoDisplay">Atleta</span></h1>
        <p>Bora completar 100% hoje?</p>
      </div>
      <div class="streak-badge">üî• <span id="streakCount">0</span></div>
    </div>
    <div class="workout-grid" id="containerTreinosAluno"></div>
    <div style="height: 80px;"></div>
  </section>

  <section id="detalheTreino" class="screen">
    <div class="sticky-header">
      <button class="btn-back" onclick="voltarTreinos()"><span class="material-icons-round">arrow_back</span> Voltar</button>
      <h2 id="tituloTreino">Treino A</h2>
    </div>
    <div class="progress-container">
      <div class="progress-text"><span>Conclus√£o</span><span id="progressoPorcentagem">0%</span></div>
      <div class="progress-bar"><div id="barraProgresso" style="width: 0%"></div></div>
    </div>
    <div id="listaExercicios" class="exercise-list"></div>
    <div style="height: 80px;"></div>
  </section>

  <section id="conta" class="screen">
    <div class="header-student">
      <h1>Meu Perfil</h1>
    </div>
    <div class="profile-card-large">
      <div class="avatar-large"><span class="material-icons-round">person</span></div>
      <h2 id="nomePerfil">Nome do Aluno</h2>
      <span class="badge-student">Aluno Regular</span>
    </div>
    <div class="info-group">
      <label>Status da Assinatura</label>
      <div id="cardVencimentoPerfil" class="due-date-card">
        <span class="material-icons-round">event</span>
        <span>Vencimento: <strong id="vencimentoPerfil">--/--</strong></span>
        <span id="statusPagamento" class="status-badge">Verificando...</span>
      </div>
    </div>
    <div class="info-group">
      <label>Telefone (Login)</label>
      <div class="info-box" id="telPerfil">...</div>
    </div>
    <button onclick="logout()" class="btn-logout-outline" style="width:100%; margin-top:20px;">Sair da Conta</button>
  </section>

  <nav class="floating-nav" id="mainNav" style="display: none;">
    <button class="nav-item" onclick="mostrarTela('estatisticas', this)">
      <span class="material-icons-round">show_chart</span>
    </button>
    <div class="nav-center-wrapper">
      <button class="nav-center-btn" onclick="mostrarTela('treinos', this)">
        <span class="material-icons-round" style="font-size: 32px;">fitness_center</span>
      </button>
    </div>
    <button class="nav-item" onclick="mostrarTela('conta', this)">
      <span class="material-icons-round">person</span>
    </button>
  </nav>

  <div id="videoModal" class="video-modal">
    <div class="video-box">
      <div class="video-header">
        <h3 id="videoTitulo">Exerc√≠cio</h3>
        <button onclick="fecharVideo()" class="close-btn"><span class="material-icons-round">close</span></button>
      </div>
      <div class="video-placeholder"><span class="material-icons-round">play_circle</span><p>V√≠deo Demonstrativo</p></div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, getDocs, doc, setDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // --- SUA CONFIGURA√á√ÉO DO FIREBASE (Otavio) ---
    const firebaseConfig = {
      apiKey: "AIzaSyAWiEakTfoZc4aSPbK09Mwy3XZYA3xgS_s",
      authDomain: "sportcenterapp-228bd.firebaseapp.com",
      projectId: "sportcenterapp-228bd",
      storageBucket: "sportcenterapp-228bd.firebasestorage.app",
      messagingSenderId: "828039171772",
      appId: "1:828039171772:web:51191d90d70dccb3ca8ab9"
    };

    // Inicia o Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Disponibiliza o Firebase para o script.js
    window.db = db;
    window.f_collection = collection;
    window.f_getDocs = getDocs;
    window.f_doc = doc;
    window.f_setDoc = setDoc;
    window.f_deleteDoc = deleteDoc;
    
    console.log("üî• Firebase Conectado com Sucesso! (Projeto: sportcenterapp-228bd)");

    // Carrega o script principal AP√ìS conectar ao banco
    const script = document.createElement('script');
    script.src = "script.js";
    document.body.appendChild(script);
  </script>

</body>
</html>